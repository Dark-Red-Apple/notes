{"version":3,"file":"index.js","mappings":"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","sources":["webpack://featured-professor/./src/index.scss","webpack://featured-professor/external window \"React\"","webpack://featured-professor/external window [\"wp\",\"apiFetch\"]","webpack://featured-professor/external window [\"wp\",\"data\"]","webpack://featured-professor/external window [\"wp\",\"element\"]","webpack://featured-professor/webpack/bootstrap","webpack://featured-professor/webpack/runtime/compat get default export","webpack://featured-professor/webpack/runtime/define property getters","webpack://featured-professor/webpack/runtime/hasOwnProperty shorthand","webpack://featured-professor/webpack/runtime/make namespace object","webpack://featured-professor/./src/index.js"],"sourcesContent":["// extracted by mini-css-extract-plugin\nexport {};","module.exports = window[\"React\"];","module.exports = window[\"wp\"][\"apiFetch\"];","module.exports = window[\"wp\"][\"data\"];","module.exports = window[\"wp\"][\"element\"];","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// wordpress package will extract it into its own file. \r\n// we need to include it in the file tree within our javascript here.\r\nimport \"./index.scss\"\r\nimport {useSelect} from \"@wordpress/data\"\r\nimport {useState, useEffect} from \"react\"\r\nimport apiFetch from \"@wordpress/api-fetch\"\r\n//shortcut from global scope of wordpress instead of importing since it may have some issues, instead of typing wp.i18n.__ typ __\r\nconst __ = wp.i18n.__\r\n\r\n// register block type on the javascript side\r\nwp.blocks.registerBlockType(\"ourplugin/featured-professor\", {\r\n  title: \"professor Callout\",\r\n  description: \"Include a short description and link to a professor \",\r\n  icon: \"welcome-learn-more\",\r\n  category: \"common\",\r\n  attributes: {\r\n    // better to define it as string\r\n    profId: {type: \"string\"}\r\n  },\r\n  edit: EditComponent,\r\n  save: function(){\r\n    return null\r\n  }  \r\n    \r\n})\r\n\r\n\r\nfunction EditComponent(props){\r\n\r\n    const[thePreview, setThePreview] = useState(\"\")\r\n\r\n    useEffect(()=>{\r\n        // with this if it won't show the last professor added when select is undefined\r\n        if(props.attributes.profId){\r\n            updateTheMeta()\r\n\r\n            // fetch the new version of \r\n            // no need to use fetch manually, it will parse the json itself too\r\n            // since it returns a promise you can use await, \r\n            // useEffect can't accept an async function directly (before () of the callback arrow function), but defining an async function inside it and then call it is okay. \r\n    \r\n            async function go(){\r\n                const response = await apiFetch(({\r\n                    // does not need the rest of address. \r\n                    path: `/featuredProfessor/v1/getHTML?profId=${props.attributes.profId}`,\r\n                    method: \"GET\"\r\n                }))\r\n                setThePreview(response)\r\n            }\r\n    \r\n            go()\r\n        }\r\n\r\n}, [props.attributes.profId])\r\n\r\nuseEffect(()=>{\r\n    // cleaner function, fresh copy of eMeta\r\n    return () => { updateTheMeta() }\r\n}, [])\r\n\r\nfunction updateTheMeta(){\r\n    // select all block types and filter for our block type\r\n    // filter(x => x.name == 'ourplugin/featured-professor') returns all sort of property of that blocktype\r\n    // map is used when we want to do something for each value of array and return an array, like only ids\r\n    // filter again no need to store the same id twice if we have the same featured block on a blog post!! \r\n    const profsForMeta =wp.data.select(\"core/block-editor\")\r\n        .getBlocks()\r\n        .filter(x => x.name == 'ourplugin/featured-professor')\r\n        .map(x=>x.attributes.profId)\r\n        .filter((x, index, arr) =>{\r\n            // indexOf will return the first one. If we have it a second time the index don't match\r\n            return arr.indexOf(x) == index\r\n        })\r\n    \r\n    console.log(profsForMeta)\r\n    wp.data.dispatch(\"core/editor\").editPost({meta: {featuredprofessor: profsForMeta }})\r\n}\r\n\r\n    const allProfs = useSelect(select=>{\r\n        //select is the tool\r\n        return select(\"core\").getEntityRecords(\"postType\",\"professor\",{per_page: -1})\r\n    })  \r\n\r\n    if(allProfs == undefined) return <p>Loading...</p>\r\n\r\n    return(\r\n        <div className=\"featured-professor-wrapper\">\r\n            <div className=\"professor-select-container\">\r\n                <select onChange={(e)=>props.setAttributes({profId: e.target.value})}>\r\n                    <option value=\"\">{__(\"Select a professor\", \"featured-professor\")}</option>\r\n                    {/* map should have return */}\r\n                    {allProfs.map( prof => \r\n                    {\r\n                        return (\r\n                            <option value={prof.id} selected={props.attributes.profId == prof.id}>\r\n                                {prof.title.rendered}\r\n                            </option>\r\n                        )\r\n                    }\r\n                    )}\r\n                </select>\r\n            </div>\r\n            <div dangerouslySetInnerHTML ={{__html: thePreview}}></div>\r\n        </div>\r\n    )\r\n}\r\n\r\n<select onChange={(e)=>props.setAttributes({profId: e.target.value})}>\r\n    <option value=\"\">Select a professor</option>\r\n    {/* map should have return */}\r\n    {allProfs.map( prof => \r\n    {\r\n        return (\r\n            <option value={prof.id} selected={props.attributes.profId == prof.id}>\r\n                {prof.title.rendered}\r\n            </option>\r\n        )\r\n    }\r\n    )}\r\n</select>"],"names":["useSelect","useState","useEffect","apiFetch","__","wp","i18n","blocks","registerBlockType","title","description","icon","category","attributes","profId","type","edit","EditComponent","save","props","thePreview","setThePreview","updateTheMeta","go","response","path","method","profsForMeta","data","select","getBlocks","filter","x","name","map","index","arr","indexOf","console","log","dispatch","editPost","meta","featuredprofessor","allProfs","getEntityRecords","per_page","undefined","e","setAttributes","target","value","prof","id","rendered","__html"],"sourceRoot":""}